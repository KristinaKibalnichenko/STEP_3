"use strict";class Modal{constructor({id:e,classes:t}){this.id=e,this.classes=t,this.modal=this.render()}render(){const e=this.createForm(this.createFormElements())||"",t=this.createElement({elem:"span",content:"X",classes:["close"]});document.querySelector(".close");t.addEventListener("click",()=>this.closeModal());const s=this.createElement({elem:"div",classes:["modal-content"],content:[t,e]});return this.createElement({elem:"div",classes:this.classes,content:[s],id:this.id})}createForm(e=[]){const t=document.createElement("form");return t.id="register-form",t.action="",t.append(...e),t}createElement({elem:e,id:t,classes:s,content:o}){const n=document.createElement(e);return t&&(n.id=t),s&&n.classList.add(...s),o&&n.append(...o),n}createFormElements(){}openModal(){this.modal.classList.add("active")}closeModal(){this.modal.classList.remove("active")}}class Input{constructor({type:e,name:t,required:s,id:o,classes:n,placeholder:a,errorText:i,value:r}){this.type=e,this.name=t,this.required=s,this.id=o,this.classes=n,this.placeholder=a,this.errorText=i,this.value=r}render(){let e=document.createElement("input");return e.type=this.type,e.name=this.name,e.required=this.required,e.id=this.id,e.classList.add(...this.classes),e.placeholder=this.placeholder,e.value=this.value,this.input=e,e}handleBlur(){return console.log("PPPPP",this.required),this.required&&(console.log(!0),this.input.validity.valid?console.log("Всё Ок"):(console.log("DBL true"),this.input.setCustomValidity(this.errorText))),!1}}class Select{constructor({id:e,classes:t,options:s}){this.id=e,this.classes=t,this.options=s}render(){const e=document.createElement("select");return this.options.forEach(t=>{const s=document.createElement("option");s.value=t,s.textContent=t,e.appendChild(s)}),this.selectList=e,e.classList.add(...this.classes),e}}class LoginModal extends Modal{constructor({id:e,classes:t}){super({id:e,classes:t})}createFormElements(){return[new Input({type:"email",name:"login",required:!0,id:"login",classes:[],placeholder:"Email address",errorText:"Поле не валидно",value:""}).render(),new Input({type:"password",name:"password",required:!0,id:"password",classes:[],placeholder:"Password",errorText:"Поле не валидно",value:""}).render(),new Input({type:"submit",name:"submit",id:"submit",classes:[],value:"SIGN IN"}).render()]}}const root=document.getElementById("header-wrapper"),loginBtn=document.getElementById("enter");console.log(loginBtn);const loginForm=new LoginModal({id:"modalLogin",classes:["modal","login"]});console.log("loginForm ",loginForm),root.after(loginForm.modal),loginBtn.addEventListener("click",(function(){loginForm.openModal();document.getElementById("submit").addEventListener("click",signIn)}));let token,status,flag=!0;function signIn(e){e.preventDefault();const t=document.getElementById("login"),s=document.getElementById("password"),o={email:t.value,password:s.value};console.log(t.value,s.value),autorization(o).then(e=>{token=e,console.log("status: ",status),console.log("token: ",e),200===status&&(loginForm.modal.remove(),loginBtn.value="Create visit",loginBtn.id="createVisit",createNewVisit(),getInfoFromDB().then(e=>{console.log("data ",e)}).catch(e=>{console.log(e.message)}))}).catch(e=>{console.log(e.message)})}function createNewVisit(){const e=document.getElementById("createVisit");console.log(e),e.addEventListener("click",()=>{console.log("И тут создается модальное окно")})}function autorization(e){return fetch("https://ajax.test-danit.com/api/cards/login",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json;charset=utf-8"}}).then(e=>(status=e.status,console.log("autorization",e),e.text())).catch(e=>{console.log("message ",e.message)})}function getInfoFromDB(){return fetch("https://ajax.test-danit.com/api/cards",{headers:{Authorization:"Bearer "+token}}).then(e=>e.json()).catch(e=>{console.log("message ",e.message)})}const content={title:"Визит к кардиологу",description:"Плановый визит",doctor:"Cardiologist",bp:"24",age:23,weight:70};async function pushInfoToDB(){return await autorization,fetch("https://ajax.test-danit.com/api/cards",{method:"POST",body:JSON.stringify(content),headers:{Authorization:"Bearer "+token,"Content-Type":"application/json;charset=utf-8"}}).then(e=>e.text()).catch(e=>{console.log("message ",e.message)})}async function deleteInfoFromDB(){return await autorization,fetch("https://ajax.test-danit.com/api/cards/7914",{method:"DELETE",headers:{Authorization:"Bearer "+token}}).then(e=>{e.text(),console.log("Deleted!!! Promise passed")}).catch(e=>{console.log("message ",e.message)})}function createSearchForm(){const e=document.createElement("form"),t=document.createElement("input"),s=document.createElement("select"),o=document.createElement("select"),n=document.createElement("input");e.action="#",e.id="searchForm",t.type="text",t.id="searchField",s.id="statusField",o.id="priorityField",n.type="submit",n.value="Search",n.id="submitField"}